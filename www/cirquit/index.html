bla
<div id ="result"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>



<script>
//var j = {"name":"ololo","timePeriod":500,"clockEnabled":true,"projectId":"c9zuc8b1ihWEciGKhIbr","focussedCircuit":41319092065,"scopes":[{"layout":{"width":100,"height":80,"title_x":50,"title_y":13,"titleEnabled":true},"allNodes":[{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[6]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[8]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[6]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[7]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[5]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[4]},{"x":270,"y":30,"type":2,"bitWidth":1,"label":"","connections":[0,2]},{"x":300,"y":50,"type":2,"bitWidth":1,"label":"","connections":[3,8]},{"x":300,"y":60,"type":2,"bitWidth":1,"label":"","connections":[1,7]}],"id":41319092065,"name":"Main","Input":[{"x":260,"y":0,"objectType":"Input","label":"E3","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":0},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":40,"id":"fSqcZHxbT6c8zqyK6spw"}]}},{"x":260,"y":60,"objectType":"Input","label":"E1","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":1},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":20,"id":"7f9Uw0ZsyTNSUdQrz40A"}]}}],"Output":[{"x":470,"y":40,"objectType":"Output","label":"A1","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":5},"constructorParamaters":["LEFT",1,{"x":100,"y":20,"id":"AelrvauDUORf29xyhqk6"}]}}],"AndGate":[{"x":330,"y":40,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[2,3],"output1":4}}}],"nodes":[6,7,8]}]};  // Beschriftet AUSGANG => AND => E3 / E1 
var j = {"name":"Kartoffel","timePeriod":500,"clockEnabled":true,"projectId":"lpdqGScMFWwDz0oy9JKZ","focussedCircuit":67058288059,"scopes":[{"layout":{"width":100,"height":100,"title_x":50,"title_y":13,"titleEnabled":true},"allNodes":[{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[6]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[8]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[15]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[18]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[8]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[7]},{"x":200,"y":-280,"type":2,"bitWidth":1,"label":"","connections":[0,7]},{"x":200,"y":-310,"type":2,"bitWidth":1,"label":"","connections":[5,6]},{"x":50,"y":-250,"type":2,"bitWidth":1,"label":"","connections":[1,4]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[10]},{"x":-10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[9]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[12]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[11]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[19]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[15]},{"x":-80,"y":-140,"type":2,"bitWidth":1,"label":"","connections":[2,14]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[19]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[18]},{"x":20,"y":-40,"type":2,"bitWidth":1,"label":"","connections":[17,3]},{"x":-110,"y":-110,"type":2,"bitWidth":1,"label":"","connections":[16,13]}],"id":67058288059,"name":"Main","Input":[{"x":-180,"y":-280,"objectType":"Input","label":"E1","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":0},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":20,"id":"0jILbNA2ZGTXsxTdJH3Q"}]}},{"x":-210,"y":-170,"objectType":"Input","label":"E2","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":9},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":40,"id":"ita1IekHMA6W7sPMQBaI"}]}},{"x":-230,"y":-110,"objectType":"Input","label":"E3","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":16},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":60,"id":"Q4r7TmzRlKyUnvO0dvDd"}]}},{"x":-170,"y":-40,"objectType":"Input","label":"E4","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":17},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":80,"id":"l0o66OPu0eAtZlhbUaFz"}]}}],"Output":[{"x":180,"y":-250,"objectType":"Output","label":"A2","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":1},"constructorParamaters":["LEFT",1,{"x":100,"y":20,"id":"5b1wWIFi0L14hTsMfuST"}]}},{"x":290,"y":-310,"objectType":"Output","label":"A1","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":5},"constructorParamaters":["LEFT",1,{"x":100,"y":40,"id":"JZ3UHjZ8lKB4j72XI26L"}]}}],"NotGate":[{"x":-180,"y":-170,"objectType":"NotGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",1],"nodes":{"output1":11,"inp1":10}}}],"AndGate":[{"x":30,"y":-130,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[2,3],"output1":4}}},{"x":-100,"y":-160,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[12,13],"output1":14}}}],"nodes":[6,7,8,15,18,19]}]};
var j = {"name":"Kartoffel3","timePeriod":500,"clockEnabled":true,"projectId":"lpdqGScMFWwDz0oy9JKZ","focussedCircuit":67058288059,"scopes":[{"layout":{"width":100,"height":120,"title_x":50,"title_y":13,"titleEnabled":true},"allNodes":[{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[35]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[9]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[7]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[4]},{"x":-10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[3]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[10]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":280,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[2,38]},{"x":170,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[9,38]},{"x":170,"y":-240,"type":2,"bitWidth":1,"label":"","connections":[1,8,34]},{"x":-160,"y":-310,"type":2,"bitWidth":1,"label":"","connections":[5,49]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":0,"y":-10,"type":1,"bitWidth":1,"label":"","connections":[14]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[13]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":100,"y":-240,"type":2,"bitWidth":1,"label":"","connections":[9,37]},{"x":110,"y":-350,"type":2,"bitWidth":1,"label":"","connections":[0,39]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[37]},{"x":100,"y":-200,"type":2,"bitWidth":1,"label":"","connections":[34,36]},{"x":220,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[7,8,40]},{"x":110,"y":-410,"type":2,"bitWidth":1,"label":"","connections":[35,44]},{"x":220,"y":-390,"type":2,"bitWidth":1,"label":"","connections":[38,43]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[45]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[46]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[40]},{"x":140,"y":-410,"type":2,"bitWidth":1,"label":"","connections":[39,45]},{"x":140,"y":-400,"type":2,"bitWidth":1,"label":"","connections":[44,41]},{"x":130,"y":-380,"type":2,"bitWidth":1,"label":"","connections":[42,47]},{"x":130,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[46,48]},{"x":-150,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[47,49]},{"x":-150,"y":-310,"type":2,"bitWidth":1,"label":"","connections":[48,10]}],"id":67058288059,"name":"Main","Input":[{"x":-60,"y":-350,"objectType":"Input","label":"E1","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":0},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":20,"id":"0jILbNA2ZGTXsxTdJH3Q"}]}},{"x":-210,"y":-170,"objectType":"Input","label":"E2","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":3},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":40,"id":"ita1IekHMA6W7sPMQBaI"}]}},{"x":-230,"y":-110,"objectType":"Input","label":"E3","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":6},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":60,"id":"Q4r7TmzRlKyUnvO0dvDd"}]}},{"x":-240,"y":-30,"objectType":"Input","label":"E4","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":11},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":80,"id":"HpQj2tbvPGoKaapUXEkg"}]}},{"x":-270,"y":30,"objectType":"Input","label":"E5","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":12},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":100,"id":"75wppexYwFPIgH3i45Ue"}]}}],"Output":[{"x":290,"y":-240,"objectType":"Output","label":"A2","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":1},"constructorParamaters":["LEFT",1,{"x":100,"y":20,"id":"5b1wWIFi0L14hTsMfuST"}]}},{"x":290,"y":-310,"objectType":"Output","label":"A1","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":2},"constructorParamaters":["LEFT",1,{"x":100,"y":40,"id":"JZ3UHjZ8lKB4j72XI26L"}]}},{"x":290,"y":-200,"objectType":"Output","label":"A3","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":36},"constructorParamaters":["LEFT",1,{"x":100,"y":60,"id":"hww8kfakpgDIIAiJ0ZKa"}]}}],"NotGate":[{"x":-180,"y":-170,"objectType":"NotGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",1],"nodes":{"output1":5,"inp1":4}}},{"x":330,"y":20,"objectType":"NotGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",1],"nodes":{"output1":21,"inp1":20}}}],"OrGate":[{"x":470,"y":-40,"objectType":"OrGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[17,18],"output1":19}}}],"AndGate":[{"x":120,"y":-90,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[14,15],"output1":16}}},{"x":170,"y":-390,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[41,42],"output1":43}}}],"NorGate":[{"x":190,"y":190,"objectType":"NorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[25,26],"output1":27}}}],"NandGate":[{"x":340,"y":160,"objectType":"NandGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[28,29],"output1":30}}}],"XorGate":[{"x":250,"y":50,"objectType":"XorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[22,23],"output1":24}}}],"XnorGate":[{"x":110,"y":90,"objectType":"XnorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[31,32],"output1":33}}}],"Ground":[{"x":110,"y":-90,"objectType":"Ground","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":13},"constructorParamaters":[1]}}],"nodes":[7,8,9,10,34,35,37,38,39,40,44,45,46,47,48,49]}]};


var j = {"name":"Kartoffel3","timePeriod":500,"clockEnabled":true,"projectId":"lpdqGScMFWwDz0oy9JKZ","focussedCircuit":67058288059,"scopes":[{"layout":{"width":100,"height":120,"title_x":50,"title_y":13,"titleEnabled":true},"allNodes":[{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[35]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[9]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[7]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[4]},{"x":-10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[3]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[10]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":280,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[2,38]},{"x":170,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[9,38]},{"x":170,"y":-240,"type":2,"bitWidth":1,"label":"","connections":[1,8,34,50]},{"x":-160,"y":-310,"type":2,"bitWidth":1,"label":"","connections":[5,49]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":10,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":0,"y":-10,"type":1,"bitWidth":1,"label":"","connections":[14]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[13]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":-20,"y":10,"type":0,"bitWidth":1,"label":"","connections":[]},{"x":30,"y":0,"type":1,"bitWidth":1,"label":"","connections":[]},{"x":100,"y":-240,"type":2,"bitWidth":1,"label":"","connections":[9,37]},{"x":110,"y":-350,"type":2,"bitWidth":1,"label":"","connections":[0,39]},{"x":10,"y":0,"type":0,"bitWidth":1,"label":"","connections":[50]},{"x":100,"y":-200,"type":2,"bitWidth":1,"label":"","connections":[34,50]},{"x":220,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[7,8,40]},{"x":110,"y":-410,"type":2,"bitWidth":1,"label":"","connections":[35,44]},{"x":220,"y":-390,"type":2,"bitWidth":1,"label":"","connections":[38,43]},{"x":-10,"y":-10,"type":0,"bitWidth":1,"label":"","connections":[45]},{"x":-10,"y":10,"type":0,"bitWidth":1,"label":"","connections":[46]},{"x":20,"y":0,"type":1,"bitWidth":1,"label":"","connections":[40]},{"x":140,"y":-410,"type":2,"bitWidth":1,"label":"","connections":[39,45]},{"x":140,"y":-400,"type":2,"bitWidth":1,"label":"","connections":[41,44]},{"x":130,"y":-380,"type":2,"bitWidth":1,"label":"","connections":[42,47]},{"x":130,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[46,48]},{"x":-150,"y":-300,"type":2,"bitWidth":1,"label":"","connections":[47,49]},{"x":-150,"y":-310,"type":2,"bitWidth":1,"label":"","connections":[10,48]},{"x":170,"y":-200,"type":2,"bitWidth":1,"label":"","connections":[37,9,36]}],"id":67058288059,"name":"Main","Input":[{"x":-60,"y":-350,"objectType":"Input","label":"E1","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":0},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":20,"id":"0jILbNA2ZGTXsxTdJH3Q"}]}},{"x":-210,"y":-170,"objectType":"Input","label":"E2","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":3},"values":{"state":0},"constructorParamaters":["RIGHT",1,{"x":0,"y":40,"id":"ita1IekHMA6W7sPMQBaI"}]}},{"x":-230,"y":-110,"objectType":"Input","label":"E3","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":6},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":60,"id":"Q4r7TmzRlKyUnvO0dvDd"}]}},{"x":-240,"y":-30,"objectType":"Input","label":"E4","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":11},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":80,"id":"HpQj2tbvPGoKaapUXEkg"}]}},{"x":-270,"y":30,"objectType":"Input","label":"E5","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":12},"values":{"state":1},"constructorParamaters":["RIGHT",1,{"x":0,"y":100,"id":"75wppexYwFPIgH3i45Ue"}]}}],"Output":[{"x":290,"y":-240,"objectType":"Output","label":"A2","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":1},"constructorParamaters":["LEFT",1,{"x":100,"y":20,"id":"5b1wWIFi0L14hTsMfuST"}]}},{"x":290,"y":-310,"objectType":"Output","label":"A1","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":2},"constructorParamaters":["LEFT",1,{"x":100,"y":40,"id":"JZ3UHjZ8lKB4j72XI26L"}]}},{"x":290,"y":-200,"objectType":"Output","label":"A3","direction":"LEFT","labelDirection":"RIGHT","propagationDelay":0,"customData":{"nodes":{"inp1":36},"constructorParamaters":["LEFT",1,{"x":100,"y":60,"id":"hww8kfakpgDIIAiJ0ZKa"}]}}],"NotGate":[{"x":-180,"y":-170,"objectType":"NotGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",1],"nodes":{"output1":5,"inp1":4}}},{"x":330,"y":20,"objectType":"NotGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",1],"nodes":{"output1":21,"inp1":20}}}],"OrGate":[{"x":470,"y":-40,"objectType":"OrGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[17,18],"output1":19}}}],"AndGate":[{"x":120,"y":-90,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[14,15],"output1":16}}},{"x":170,"y":-390,"objectType":"AndGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[41,42],"output1":43}}}],"NorGate":[{"x":190,"y":190,"objectType":"NorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[25,26],"output1":27}}}],"NandGate":[{"x":340,"y":160,"objectType":"NandGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[28,29],"output1":30}}}],"XorGate":[{"x":250,"y":50,"objectType":"XorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[22,23],"output1":24}}}],"XnorGate":[{"x":110,"y":90,"objectType":"XnorGate","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":100,"customData":{"constructorParamaters":["RIGHT",2,1],"nodes":{"inp":[31,32],"output1":33}}}],"Ground":[{"x":110,"y":-90,"objectType":"Ground","label":"","direction":"RIGHT","labelDirection":"LEFT","propagationDelay":0,"customData":{"nodes":{"output1":13},"constructorParamaters":[1]}}],"nodes":[7,8,9,10,34,35,37,38,39,40,44,45,46,47,48,49,50]}]};

lookup = []

globDbg = true;

O = j.scopes[0];

function addToLookup(lookup, entities, oType, type){

// e.g. AndGate gives an array of two of its kind.

   for(key in entities){
   nodesOut = [];
   text ="";
    nodesIn  =  entities[key].customData.nodes.inp; 
    if(window.globDbg) console.log(">>>>>>"+key);
    if(nodesIn == undefined || nodesIn.length == 0){
    //if(oType == "NotGate"){ // Todo judz check for nodes.inp1 
    nodesIn = [ entities[key].customData.nodes.inp1 ];
    }
    switch(type){
 
    case "inp":
    text = entities[key].label;
    break;
    case "gate":
    
    case "static":
    break;
    default: 
    console.log("Type " + type + " not implemented");
    }
    nodeOut =  entities[key].customData.nodes.output1;
    lookup[nodeOut] = {nodesIn, text, oType,  type, nodeOut};
    }
}

function makeLookup(lookup, scope){
    for(key in j.scopes[0]){
        O = j.scopes[0][key];
        switch(key){
            case "AndGate":          addToLookup(lookup, O , key, "gate");     break;
            case "Ground":            addToLookup(lookup, O , key, "static");   break;
            case "Input":               addToLookup(lookup, O , key,  "inp");      break;
            case "NandGate":       addToLookup(lookup, O , key, "gate");    break;
            case "NorGate":         addToLookup(lookup, O , key, "gate");     break;
            case "NotGate":         addToLookup(lookup, O , key, "gate");     break;
            case "OrGate":           addToLookup(lookup, O , key, "gate");     break;
            case "Power":            addToLookup(lookup, O , key, "static");    break;
            case "XnorGate":       addToLookup(lookup, O , key, "gate"); break;
            case "XorGate":         addToLookup(lookup, O , key, "gate");  break;
        }
    }
}

function findNextNodes(outNode, lookup, allNodes, nodeBefore){
    var node = allNodes[outNode];
    var connectingNodes = JSON.parse(JSON.stringify( node.connections ));
   
  lengthbefore = connectingNodes.length;
        var index = connectingNodes.indexOf(nodeBefore[nodeBefore.length -2]);
        if (index !== -1) connectingNodes.splice(index, 1);
        lengthafter = connectingNodes.length;
   
    if(window.globDbg) console.log(connectingNodes);
   if(connectingNodes.length == 0){console.log("NO CONN NODES"); console.log(nodeBefore); }
    return connectingNodes;
}


function followXGate(outNodes,gateType, lookup, allNodes, gateNode){
        
var textPre = ""; 
var retText;

switch(gateType){
        case "XnorGate":    retText +="!";   // fallthrough;  these both need special handeling.        (-1 so wont stop at this OUT )
        case "XorGate":      
        break;
        default:    return -1;
        break;
}


  // XOR = (A |  B ) & !( A & B)   so just call followGate again and fake who we are ;) 
   var    orText   = followGate(outNodes, "OrGate",     lookup, allNodes, gateNode);
   var andText   = followGate(outNodes, "NandGate", lookup, allNodes, gateNode);
   
   if(andText >= 0 && orText >= 0){
                retText += " ( " + orText + " & " + andText + ")";
    }
    
    return retText;
    
       
    
}

function followGate(outNodes, gateType, lookup, allNodes, gateNode){
var gateNode = JSON.parse(JSON.stringify(gateNode));
var textPre = "";
var textMid = "";
switch(gateType){
        case "XnorGate":   // fallthrough;  these both need special handeling.        (-1 so wont stop at this OUT )
        case "XorGate":      return followXGate(outNodes, gateType, lookup, allNodes, gateNode);   
        break;
       
        case "NandGate":       
        case "NotGate":         textPre +="!";
        case "AndGate":         textPre+= "("; textMid = " & "; textEnd =")";
        break;
        
        case "NorGate":        textPre += "!"; 
        case "OrGate":          textPre += "("; textMid = " | "; textEnd = ")";
        break;   
        default: return -1;
        break;
    }
    
    var retText;
    
    retText =  JSON.parse(JSON.stringify(textPre));
    var i = 0;
    var t = 0;
    var u = 0;
    if(window.globDbg) console.log("GateType Entry: "+gateType);
    if(window.globDbg) console.log("OutNodes len "+outNodes.length);
    if(window.globDbg) console.log(outNodes);
    
    var oldNode;
    // If the GateNode is not in the lookup, it's a Wire Y - ing, so we have to keep the info where we come from.
    if( !lookup.hasOwnProperty(gateNode)){
        oldNode = gateNode;
    }
    else{
        // Otherwise we set it to empty array, to prevent it stopping at the next element which will be an Input of a gate.
        oldNode = [];
    }
    
    
    lastKey = "Ã–";
    nextNodeKey = "unsinn";
    for(nextNodeKey in outNodes){
    var nextElement = -1;
    if(window.globDbg) console.log("Runs: "+(++u));
        if(lastKey == nextNodeKey){
        if(window.globDbg) console.log("LASTKEY "+lastKey+" == NEXT KEY "+nextNodeKey+" T= "+(t++));
        }
        else{
        if(window.globDbg) console.log("LASTKEY != NEXT KEY");
       // break;
        }
        
       
        nextElement = followTree(outNodes[nextNodeKey], lookup, allNodes,oldNode);
        if(window.globDbg) console.log("GateType: "+gateType+ " " +textMid+ " #"+gateNode);
        if(window.globDbg) console.log("NextElement: "+nextElement);
        if(window.globDbg) console.log("PreviousElement: "+previousElement);
        // If element is -1 then skip. 
        if(nextElement != -1 && nextElement != -2){
                console.log("Making entry "+i+"... adding "+nextElement+ " from outNode: " +outNodes[nextNodeKey]+ " to string content: "+retText);
                if(textMid ==""){console.log("EMPTY!!!");}
                if(i++ > 0 ) retText +=  JSON.parse(JSON.stringify(textMid)); 
                retText +=  JSON.parse(JSON.stringify(nextElement));
                var previousElement = nextElement;
        }
        else{
        
        console.log("Skipping next element "+ nextElement);
        console.log(outNodes);
        }
         
         lastKey=nextNodeKey;

    
    }
    
      retText +=  JSON.parse(JSON.stringify(textEnd));
      
      // Special cases to get rid of too many braces...
      // All elements were skipped... so no braces either... and return -1 because this ends in something bad else. 
      if(i == 0){
       return -1;
      }
      
      // One made it through.... so just return that one without braces. 
      // If there were more than one to make it we need the braces and concat signs (e.g. & ) anyway!
      else if(i == 1 && textPre !="!("){
        return previousElement;
      }
      
   if(window.globDbg)   console.log("Iteration retText is: "+retText);
   if(window.globDbg)  console.log("GateType: "+gateType);
   if(window.globDbg)  console.log("Returning :" +retText);
    return retText;

}



glob_i = 0;

function printType(type){
t_aus =0;
t_ein = 1;
t_ltg  = 2;

switch(type){
case t_aus: return "Ausgang"; 
case t_ein: return "Eingang";
case t_ltg: return "Leitung";

}
}

//                              Node to befin                        Stop at Output?
function followTree(outNode, lookup, allNodes, NODESBefore){
// Explicitly make a COPY of the array instead of working on the old one.
var nodeBefore = JSON.parse(JSON.stringify(NODESBefore));
t_aus =0;
t_ein = 1;
t_ltg  = 2;

node = allNodes[outNode];

if(window.globDbg) console.log("Stacksize: "+window.glob_i++);
if(window.glob_i >  550) return "-2"; // Remove? 

if(window.globDbg) console.log("##########################");
if(window.globDbg) console.log("Node: " +outNode);
if(window.globDbg) console.log(printType(node.type));
if(window.globDbg) console.log("Node before: "+nodeBefore[nodeBefore.length -1]);


// If this is not the entry point, and we reach an output, we're in a dead end.
if(nodeBefore.length > 0 && node.type == t_aus){
    if(window.globDbg) console.log("dead end");
    return -1;
}

if(nodeBefore.indexOf(outNode) != -1){
    console.log("Error: Circularity detected. Breaking the circle!");
    return -1;
}

nodeBefore.push(outNode); // Push this node to the stack of recent nodes.

nextNodes = -1;
ft = "nonsence";
switch(node.type){

// If it is a output, or a connection, go deeper in the rabbithole. 
case t_aus: case t_ltg:
     if(window.globDbg) console.log(">>>>>>>>Node Before: "+nodeBefore[nodeBefore.length -1]+ " OutNode: "+outNode+"   >>>>>>>>>");
      nextNodes = findNextNodes(outNode,lookup, allNodes, nodeBefore);
      
      if(nextNodes.length == 1){
        if(window.globDbg &&nextNodes[0] === undefined){ console.log("Next ~~~~~ Nodes[0] undefined: "); console.log(nextNodes);}
            
             if(window.globDbg) console.log(">>>Ret Message from thisNode: "+outNode+" nextNode "+nextNodes[0]+" is: "+ft);
             
             ft = followTree(nextNodes[0], lookup, allNodes, nodeBefore);
             if(ft == ""){ return -1;} 
             return ft;
     }
     
     else if(nextNodes.length > 1){
     // if we come here, the way goes in two directions... threting like "OR", so we're faking one and delegate to followGate ;-) 
       if(window.globDbg)  console.log("X X X ing in cirquit! "+outNode);
        return followGate(nextNodes, "OrGate", lookup, allNodes, nodeBefore);
     }
     
     else{
        // the Element is not connected ... dead end...
        if(window.globDbg) console.log("X X X dead end");
        return -1;
     }
 
break;

case t_ein: 
    // If it is a Input, find out if it's REALLY an input, or just the input of a gate.
    // All inputs have to be in the lookup Array. 
    lookupEntry  = lookup[outNode];
    
    if(window.globDbg)  console.log("Input");
    // If the type is input, we reached a endpoint.
    if(lookupEntry.type == "inp" ||  lookupEntry.type == "static"){
       if(window.globDbg)  console.log("EXIT POINT");
       if(window.globDbg) console.log(lookupEntry.text);
       if(window.globDbg) console.log("^^^^^^^^^");
      
        return lookupEntry.text;
    }

    // When it is a gate we need to go down all paths (for each input of the gate) 
    else if(lookupEntry.type == "gate"){
       if(window.globDbg)  console.log("X X X typ gate");
        nodesIn = lookupEntry.nodesIn;
        return followGate(nodesIn, lookupEntry.oType, lookup, allNodes, outNode);  
    }

    else{
    console.log("Error: element not properly in lookup");
    }


break;
}

}





















outputs =   j.scopes[0].Output;
allNodes = j.scopes[0].allNodes;



makeLookup(lookup, j.scopes[0]);




logicStrings = [];
u = 0;
// Now build Outputs :-) 
for (key in outputs){

outName = outputs[key].label;
outNode  = outputs[key].customData.nodes.inp1;
allNodes = JSON.parse(JSON.stringify(allNodes));
lookup   = JSON.parse(JSON.stringify(lookup));

logicString = followTree(outNode, lookup, allNodes, []);
completeLogic = outName + "=" + logicString;
document.getElementById("result").innerHTML += completeLogic + "<br>";
console.log("Completed "+completeLogic);
console.log("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
console.log("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
//break; //TODO remove
}




</script>
